<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/layout1.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
          integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap%27;">
    <title>Trả sách</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Be Vietnam Pro', sans-serif;
    }

    /* Header */
    header {
        display: grid;
        grid-template-columns: auto auto;
        align-items: center;
        justify-content: space-between;
        border-bottom: 2px solid #333;
        /* background-color: rgb(104, 104, 237); */
        background-color: #4466cc;
        padding: 10px 20px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
    }

    /* Cố định header */
    header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        /* Chiếm toàn bộ chiều rộng */
        z-index: 1000;
        /* Đảm bảo header nằm trên các thành phần khác */
        background-color: #4466cc;
        /* Màu nền để header không trong suốt */
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        /* Tạo hiệu ứng đổ bóng */
    }

    /* Bên trái*/
    .header_layout1 {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .header_layout1 p {
        font-size: 1.2em;
        color: rgb(231, 231, 29);
    }

    /* Bên phải */
    .header_layout2 {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .header_layout2 p {
        font-size: 1em;
        color: white;
    }

    /* icon */
    i {
        color: white;
        font-size: 1.5em;
        cursor: pointer;
    }

    /*  menu */
    ul {
        list-style-type: none;
        background-color: rgb(104, 104, 237);
        padding: 10px 0;
        margin: 0;
        width: 250px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
    }

    .tong {
        display: grid;
        grid-template-columns: auto auto;
    }

    .menu_tittle li {
        display: flex;
        align-items: center;
        padding: 10px;
        width: 100%;
        color: white;
        transition: background-color 0.3s ease;
    }

    .menu_tittle li:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .menu_tittle li i {
        margin-right: 10px;
        font-size: 20px;
    }

    .menu_tittle li a {
        text-decoration: none;
        color: white;
        flex-grow: 1;
    }

    /* Quản lý mượn trả */
    .father_muon_tra {
        position: relative;
    }

    .muon_tra {
        position: absolute;
        width: max-content;
        top: -10px;
        left: 100%;
        display: none;
    }

    .father_muon_tra:hover .muon_tra {
        display: grid;
    }

    /* dropdown icon */
    .menu_tittle li .fa-chevron-down {
        margin-left: auto;
    }

    .container_right {
        flex: 1;
        display: flex;
        justify-content: center;
        /* Căn giữa theo chiều ngang */
        align-items: center;
        /* Căn giữa theo chiều dọc */
        padding: 20px;
        background-color: #f9f9f9;
        min-height: calc(100vh - 80px);
        /* Chiều cao bao phủ toàn bộ phần trừ đi chiều cao header */
        margin-top: 40px;
        margin-left: -26%;
        /* Để tránh bị header đè */

    }

    .container {
        width: 100%;
        max-width: 700px;
        /* Giới hạn chiều rộng */
        background-color: #fff;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        /* Hiệu ứng đổ bóng */
        text-align: center;
        /* Căn chữ giữa trong phần container */
    }

    #timKiemSach {
        width: 100%;
        padding: 10px;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 20px;
    }

    h1,
    h2 {
        color: #34495e;
        margin-bottom: 20px;
        font-size: 1.8rem;
    }

    .form-group {
        margin-bottom: 20px;
        text-align: left;
        /* Đảm bảo nhãn và input không bị căn giữa */
    }

    label {
        font-weight: bold;
        margin-bottom: 5px;
        display: block;
    }

    input {
        width: 100%;
        padding: 10px;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    button {
        width: 100%;
        padding: 12px;
        background-color: #3498db;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    button:hover {
        background-color: #2980b9;
        transform: scale(1.05);
        /* Nhấn mạnh hiệu ứng hover */
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th,
    td {
        text-align: left;
        padding: 12px;
        border: 1px solid #ddd;
    }

    th {
        background-color: #2c3e50;
        color: #fff;
    }

    tbody tr:nth-child(odd) {
        background-color: #f4f4f4;
    }

    .action-btn {
        color: red;
        cursor: pointer;
        font-weight: bold;
    }

    .action-btn:hover {
        text-decoration: underline;
    }

    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .modal-buttons {
        margin-top: 20px;
        display: flex;
        justify-content: space-around;
    }

    .modal-buttons button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .modal-buttons button:first-child {
        background-color: #e74c3c;
        color: white;
    }

    .modal-buttons button:first-child:hover {
        background-color: #c0392b;
    }

    .modal-buttons button:last-child {
        background-color: #2ecc71;
        color: white;
    }

    .modal-buttons button:last-child:hover {
        background-color: #27ae60;
    }

    #nhapMSV {
        width: 200px;
        /* Giảm chiều rộng */
        height: 30px;
        /* Điều chỉnh chiều cao */
        font-size: 14px;
        /* Giảm kích thước chữ */
    }

    textarea {
        width: 100%;
        height: 150px;
        /* Tăng chiều cao */
        font-size: 16px;
        /* Tăng kích thước chữ */
        resize: none;
        /* Không cho phép thay đổi kích thước bằng chuột */
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
        box-sizing: border-box;
    }
</style>
</head>

<body>
    <header>
        <div class="header_layout1">
            <p>THƯ VIỆN TRƯỜNG THCS ABC</p>
            <i class="fa-solid fa-bars"></i>
        </div>
        <div class="header_layout2">
            <i class="fa-solid fa-circle-user"></i>
            <p>Administrator</p>
            <i class="fa-solid fa-chevron-down"></i>
        </div>
    </header>
    <div class="tong">
        <div class="content_menu">
            <ul class="menu_tittle">
                <li><i class="fa-solid fa-house"></i><a href="">Trang chủ</a><i class="fa-solid fa-chevron-down"></i>
                </li>
                <li><i class="fa-solid fa-gear"></i><a href="">Hệ thống</a><i class="fa-solid fa-chevron-down"></i></li>
                <li><i class="fa-solid fa-newspaper"></i><a href="">Quản lý tin tức</a><i
                        class="fa-solid fa-chevron-down"></i>
                </li>
                <li><i class="fa-solid fa-list-check"></i><a href="">Danh mục</a><i
                        class="fa-solid fa-chevron-down"></i>
                </li>
                <li><i class="fa-solid fa-floppy-disk"></i><a href="">Trang Quản lý kho kệ</a><i
                        class="fa-solid fa-chevron-down"></i></li>
                <li><i class="fa-solid fa-file-import"></i><a href="">Quản lý nhập xuất</a><i
                        class="fa-solid fa-chevron-down"></i></li>
                <li><i class="fa-solid fa-book"></i><a th:href="@{/}">Tạo mới sách</a><i
                        class="fa-solid fa-chevron-down"></i>
                </li>
                <li><i class="fa-solid fa-bookmark"></i><a th:href="@{/sach/danhSachSach}">Ấn phẩm kho</a><i
                        class="fa-solid fa-chevron-down"></i>
                </li>
                <li class="father_muon_tra"><i class="fa-solid fa-bandage"></i><a href="">Quản lý mượn trả</a><i
                        class="fa-solid fa-chevron-down">
                        <ul class="muon_tra">
                            <li><a th:href="@{/sach/muon-sach}">Mượn sách</a></li>
                            <li><a th:href="@{/sach/tra-sach}">Trả sách</a></li>
                        </ul>
                    </i>
                </li>
                <li><i class="fa-solid fa-flag"></i><a href="/Bao_cao/baocao.html">Báo cáo</a><i
                        class="fa-solid fa-chevron-down"></i></li>
            </ul>
        </div>
        <div class="content_muonSach">
            <label>Nhập vào mã học sinh : </label>
            <div th:if="${student != null}">
                <input type="text" name="nhapMSV" class="nhapMSV" th:value="${student.getMaTK()}" required >
            </div>
            <div th:if="${student == null}">
                <input type="text" name="nhapMSV" class="nhapMSV"  required>
            </div>
            <p style="color: red" th:if="${message != null}" th:text="${message}"></p>
            <a onclick="loadHocSinh()" role="button" class="timKiemHocSinh btn btn-primary ">Tìm kiếm</a>
            <script>
                function loadHocSinh() {
                    const maHocSinh = document.querySelector(".nhapMSV").value;
                    if (maHocSinh === "") {
                        alert("Vui lòng nhập mã học sinh!");
                    }
                    document.querySelector('.timKiemHocSinh').href = "/sach/loadHocSinh/" + maHocSinh+"--Tra_sach";
                }
            </script>
            <p>Thông tin học sinh : </p>
            <div th:if="${student != null}">
                <textarea name="" th:text="${student.getTenHienThi()}"></textarea>
            </div>
            <div th:if="${student == null}">
                <textarea name="" id=""></textarea>
            </div>
            <table th:if="${sachMuon != null}">
                <thead>
                    <tr>
                        <th>STT</th>
                        <th>Mã sách</th>
                        <th>Ngày mượn</th>
                        <th>Ngày trả</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="sach, iStats : ${sachMuon}">
                        <td><input type="number" name="STT" id="STT1" value="1"></td>
                        <td><input type="text" name="masach" id="masach1" th:value="${sach.maSach}"></td>
                        <td><input type="date" name="date_muon" id="date_muon1" th:value="${sach.ngayMuon}"></td>
                        <td><input type="date" name="date_tra" id="date_tra1" th:value="${sach.ngayTra}"></td>
                        <td><a role="button" class="btn btn-warning" onclick="return confirm('Bạn muốn trả cuốn sách này ?')" th:href="@{/sach/tra-mot-sach(maPhieu=${sach.maPhieu}, maHocSinh=${student.maTK},maSach=${sach.maSach})}">Trả sách</a></td>
                    </tr>
                    <tr>
                        <td colspan="5"><a role="button" class="btn btn-primary" th:href="@{/sach/tra-tat-ca-sach(maHocSinh=${student.maTK})}">Trả tất cả sách</a></td>
                    </tr>

                </tbody>
            </table>
        </div>
    </div>
    </div>
    </div>
    <!-- Modal thông báo -->
    <div id="modalXacNhan" class="modal">
        <div class="modal-content">
            <h3>Xác nhận mượn sách</h3>
            <p>Bạn có chắc chắn muốn xác nhận trả sách không?</p>
            <div class="modal-buttons">
                <button onclick="dongModal()">Hủy</button>
                <button onclick="dongModal(true)">Đồng ý</button>
            </div>
        </div>
    </div>
    <script>
        // Mở modal
        function moModal() {
            document.getElementById("modalXacNhan").style.display = "flex";
        }

        // Đóng modal
        function dongModal(dongY = false) {
            document.getElementById("modalXacNhan").style.display = "none";
            if (dongY) {
                alert("Xác nhận trả sách thành công!");
            }
        }

        // Gán sự kiện cho nút "Trả sách"
        const nutTraSach = document.querySelectorAll("button");
        nutTraSach.forEach((button, index) => {
            if (button.innerText === "Trả sách") {
                button.addEventListener("click", () => {
                    moModal();
                });
            }
        });

        // Gán sự kiện cho nút "Trả tất cả sách"
        const nutTraTatCa = document.querySelector("button[onclick='']");
        if (nutTraTatCa) {
            nutTraTatCa.addEventListener("click", () => {
                moModal();
            });
        }
    </script>
</body>

</html>